generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model User {
  id        Int      @id @default(autoincrement())
  name      String
  email     String   @unique
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  @@index([email])
}

model Location {
  id      Int    @id @default(autoincrement())
  country String
  state   String?
  city    String
  latitude Float?
  longitude Float?

  records ClimateRecord[]

  @@index([country, state, city])
}

model ClimateMetric {
  id          Int    @id @default(autoincrement())
  name        String @unique
  unit        String
  description String?

  records ClimateRecord[]

  @@index([name])
}

model ClimateRecord {
  id         Int      @id @default(autoincrement())
  date       DateTime
  value      Float
  locationId Int
  metricId   Int
  createdAt  DateTime @default(now())
  updatedAt  DateTime @updatedAt

  location Location      @relation(fields: [locationId], references: [id], onDelete: Cascade)
  metric   ClimateMetric @relation(fields: [metricId], references: [id], onDelete: Cascade)

  @@index([date])
  @@index([locationId])
  @@index([metricId])
  @@index([locationId, metricId, date])
  @@unique([locationId, metricId, date])
}

